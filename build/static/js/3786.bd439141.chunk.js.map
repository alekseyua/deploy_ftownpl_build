{"version":3,"file":"static/js/3786.bd439141.chunk.js","mappings":"iRAYMA,GAAiBC,EAAAA,EAAAA,IAAe,kBAAM,+BAA2B,IA8KvE,UAnKgC,SAAHC,GAUvB,IATFC,EAAcD,EAAdC,eACAC,EAAaF,EAAbE,cACAC,EAAaH,EAAbG,cACAC,EAAWJ,EAAXI,YACAC,EAASL,EAATK,UACAC,EAASN,EAATM,UACAC,EAAIP,EAAJO,KACAC,EAAGR,EAAHQ,IAGQC,GAAaC,EAAAA,EAAAA,MAAbD,SACRE,GAAsCC,EAAAA,EAAAA,UAAST,GAAcU,GAAAC,EAAAA,EAAAA,GAAAH,EAAA,GAArDI,EAAUF,EAAA,GAAEG,EAAaH,EAAA,GACjCI,GAAkDL,EAAAA,EAAAA,WAAS,GAAMM,GAAAJ,EAAAA,EAAAA,GAAAG,EAAA,GAAzDE,EAAgBD,EAAA,GAAEE,EAAmBF,EAAA,GACvCG,GAAWC,EAAAA,EAAAA,MACjBC,GAA8CX,EAAAA,EAAAA,UAAS,CACnDY,KAAK,EACLC,OAAO,IACTC,GAAAZ,EAAAA,EAAAA,GAAAS,EAAA,GAHMI,EAAcD,EAAA,GAAEE,EAAiBF,EAAA,IAKzCG,EAAAA,EAAAA,YAAU,WACLzB,GAECgB,EADCnB,EAAiB,GAMlBmB,IADEnB,EAAiBE,KAMrBiB,GAAoB,EAExB,GAAE,CAAChB,EAAYH,EAAeE,IAE9B,IAAM2B,EAAa,WAEjB,OADArB,EAAS,gBAAgB,CAACsB,MAAM,KACzB,CACT,GA8EAF,EAAAA,EAAAA,YAAU,WACL1B,IAAkBY,GAAYC,EAAcb,EACjD,GAAE,CAACA,IAGH,IAAA6B,GAA0CpB,EAAAA,EAAAA,UAAS,uCAAsCqB,GAAAnB,EAAAA,EAAAA,GAAAkB,EAAA,GAAlFE,EAAaD,EAAA,GAAEE,EAAgBF,EAAA,IACtCJ,EAAAA,EAAAA,YAAU,WAAO,IAADO,EACVC,EAAcC,KAAUF,EAAA,IAAAG,EAAAA,EAAAA,GAAAH,EACzBI,EAAAA,EAAAA,mDAA2Db,EAAeH,MAAGe,EAAAA,EAAAA,GAAAH,EAC7EI,EAAAA,EAAAA,qDAA6Db,EAAeF,OAAKW,IAGpFD,EAAiBE,EACnB,GAAG,CAACV,EAAeH,IAAKG,EAAeF,QAavC,OACIgB,EAAAA,EAAAA,KAAC3C,EAAc,CACb4C,kBAZoB,SAAClC,EAAKF,GAC9B,OAAKA,GAEHmC,EAAAA,EAAAA,KAACE,EAAAA,QAAM,CAACC,KAAI,IAAAC,OAAMrC,GAAOsC,MAAI,EAACC,QAAS,kCAAmCC,QAAWlB,EAAWmB,SAAC,kJAF5E,IAMzB,EAMMC,iBA3DmB,SAACC,EAAO7C,EAAWD,GAExCuB,EADY,IAAVuB,EACgB,SAAAC,GAAC,OAAAC,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GACZD,GAAC,IACJ5B,KAAK,EACLC,OAAO,GAAI,EAGG,SAAA2B,GAAC,OAAAC,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GACdD,GAAC,IACJ5B,KAAK,EACLC,OAAO,GAAK,GAgBhB,OADAhB,EAAS,YANM,CACbJ,UAAAA,EACA8C,MAAAA,EACA7C,UAAAA,EACAgD,WAViB,SAAAC,GACjB,IAAMC,EAAeC,YAAW,WAE9B,OADApC,EAASkC,GACF,kBAAMG,aAAaF,EAAc,CAC1C,GAAE,IACJ,KAQOlD,GAAWwB,GACpB,EAgCMX,iBAAqBA,EACrBhB,cAAkBA,EAClB+B,cAAkBA,EAClBhC,cAAkBA,EAClBa,WAAeA,EACfT,UAAcA,EACdwB,WAAYA,EACZzB,UAAcA,EACdsD,UAlHY,SAACC,GACf,IAAIC,EAMEC,GAJJD,EADCD,EAAEG,OAAOd,SAAS,GACRW,EAAEG,OAAOd,SAAS,GAElBW,EAAEG,OAAOC,aAAaf,SAAS,GAAGA,SAAS,GAAGgB,YAEhCC,WAAU,GAC/BC,EAAuBN,EAASrB,MAAM4B,gBACtCC,EAAiBR,EAASS,YAC1BC,EAAkBV,EAASW,aAC3BC,EAAeZ,EAASa,wBAAwBC,IAChDC,EAAgBf,EAASa,wBAAwBG,KAIvDf,EAAUgB,UAAUC,IAAI,aAC1BjB,EAAUtB,MAAMwC,QAAO,mBAAAnC,OACb+B,EAAa,uBAAA/B,OACb4B,EAAY,wBAAA5B,OACXwB,EAAc,yBAAAxB,OACb0B,EAAe,eAG3BU,SAASC,KAAKC,OAAOrB,GAErB,IAAMsB,EAAYH,SAASI,cAAc,YACnCC,EAAeF,EAAUV,wBAAwBC,IACjDY,EAAgBH,EAAUV,wBAAwBG,KAExDf,EAAUtB,MAAMwC,QAAO,mBAAAnC,OACb0C,EAAa,uBAAA1C,OACbyC,EAAY,mCAAAzC,OACAsB,EAAoB,2GAM1C,IAAMqB,EAAQ/B,YAAW,WAEvB,OADAK,EAAU2B,SACH,kBAAM/B,aAAa8B,EAAM,CAClC,GAAG,IACL,EAwEMjF,KAASA,EACTC,IAAQA,GAGlB,C,sBCvLA,KAAgB,sCAAsC,4DAA4D,kDAAkD,wEAAwE,0DAA0D,gFAAgF,8CAA8C,oEAAoE,6CAA6C,mEAAmE,yCAAyC,+DAA+D,+CAA+C,qEAAqE,yCAAyC,+DAA+D,wCAAwC,8DAA8D,sCAAsC,4DAA4D,kDAAkD,wEAAwE,YAAc,oC","sources":["Views/ProductDetailsViews/ControlButtons/ControlButtonsContainer.js","webpack://ftownpl/./src/Views/ProductDetailsViews/ControlButtons/style/controlbuttons.module.scss?a1e8"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport AsyncComponent from '../../../helpers/asyncComponent';\r\nimport Button from '../../Button';\r\nimport classNames from 'classnames';\r\n\r\nimport style from './style/controlbuttons.module.scss';\r\nimport { useStoreon } from 'storeon/react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { ROLE } from '../../../const';\r\nimport { textErrorMessage } from '../../../store/modalStorage/modalWindow/modalWindow';\r\nimport { errorAlertIcon } from '../../../images';\r\n\r\nconst ControlButtons = AsyncComponent(() => import( './ControlButtons'));\r\n/**\r\n * \r\n * @param {\r\n * 1) при добавлении товара цвет кнопки кратковременно меняет цвет на зелёный\r\n * 2) иконка с кнопки клонируется и перемещаеться к хэдер меню и там меняеться численость\r\n * 3) \r\n * } param0 \r\n * @returns \r\n */\r\n\r\nconst ControlButtonsContainer = ({\r\n    in_stock_count,\r\n    is_collection,\r\n    in_cart_count,\r\n    is_in_stock,\r\n    productId,\r\n    modalView,\r\n    role,\r\n    url,\r\n\r\n}) =>{\r\n    const { dispatch } = useStoreon();\r\n    const [ countInBtn, setCountInBtn ] = useState(in_cart_count);\r\n    const [ stateInStockeBtn, setStateInStockeBtn ] = useState(false);\r\n    const navigate = useNavigate();\r\n    const [ changeColorBtn, setChangeColorBtn ] = useState({\r\n        red: false,\r\n        green: false\r\n    })\r\n\r\n    useEffect(()=>{ \r\n      if(is_in_stock){\r\n        if(in_stock_count < 1){\r\n          setStateInStockeBtn(true)\r\n        } else {\r\n          setStateInStockeBtn(false)\r\n        }\r\n        if (in_stock_count > in_cart_count){\r\n          setStateInStockeBtn(false)\r\n        }else{\r\n          setStateInStockeBtn(true)\r\n        }\r\n      }else{\r\n        setStateInStockeBtn(false)\r\n      }\r\n    },[is_in_stock,in_stock_count,in_cart_count])\r\n\r\n    const closeModal = () => {\r\n      dispatch('setModalState',{show: false})\r\n      return true;\r\n    }\r\n\r\n    const cloneCart = (e) =>{\r\n        let cartIcon\r\n        if(e.target.children[0]){\r\n          cartIcon = e.target.children[0]\r\n        }else{\r\n          cartIcon = e.target.offsetParent.children[0].children[1].firstChild\r\n        }\r\n        const cloneIcon = cartIcon.cloneNode(true)\r\n        const cloneBackgroundImage = cartIcon.style.backgroundImage;\r\n        const cloneIconWidth = cartIcon.offsetWidth;//ширина изображения\r\n        const cloneIconHeight = cartIcon.offsetHeight;// высота изображения\r\n        const cloneIconTop = cartIcon.getBoundingClientRect().top;// позиция изображения на странице от верха\r\n        const cloneIconLeft = cartIcon.getBoundingClientRect().left;//позиция изображения на странице от левого края\r\n        \r\n        //присваиваем стили нашей картинке\r\n        // cloneIcon.setAttribute('class', '_flyImage');\r\n        cloneIcon.classList.add('_flyImage')\r\n      cloneIcon.style.cssText = `\r\n        left: ${cloneIconLeft}px;\r\n        top:  ${cloneIconTop}px;\r\n        width: ${cloneIconWidth}px;\r\n        height: ${cloneIconHeight}px;\r\n      `\r\n      //добавляем клон на страницу\r\n      document.body.append(cloneIcon)\r\n      // получаем координаты корзины по id 'cart-id'\r\n      const getCartId = document.querySelector('#cart-id')\r\n      const getCartIdTop = getCartId.getBoundingClientRect().top;// позиция изображения на странице от верха\r\n      const getCartIdLeft = getCartId.getBoundingClientRect().left;// позиция изображения на странице от левого края\r\n\r\n      cloneIcon.style.cssText = `\r\n        left: ${getCartIdLeft}px;\r\n        top:  ${getCartIdTop}px;\r\n        background-image: ${cloneBackgroundImage};\r\n        width: 0px;\r\n        height: 0px;\r\n        opacity: 0;\r\n        transform: scale(.5)\r\n      `\r\n      const timer = setTimeout(() => {\r\n        cloneIcon.remove()\r\n        return () => clearTimeout(timer)\r\n      }, 4000)\r\n    }\r\n  \r\n    //******************************************************************************************************* */\r\n    const addToCartProduct = (count, modalView, productId) => {\r\n      if (count === 1){\r\n        setChangeColorBtn(c=>({\r\n            ...c,\r\n            red: false,\r\n            green: true\r\n        }))\r\n      }else{\r\n        setChangeColorBtn(c=>({\r\n          ...c,\r\n          red: true,\r\n          green: false\r\n        }))\r\n      }\r\n      const redirectTo = path => {\r\n        const timerTimeout = setTimeout(()=>{\r\n          navigate(path);\r\n          return () => clearTimeout(timerTimeout);          \r\n        },100)\r\n      }\r\n      const params = {\r\n        productId,\r\n        count,\r\n        modalView,\r\n        redirectTo,\r\n      }\r\n      dispatch('addToCart', params);      \r\n      return modalView? closeModal() : true;\r\n    };\r\n  \r\n    useEffect(()=>{\r\n      if(in_cart_count !== countInBtn) setCountInBtn(in_cart_count);\r\n    },[in_cart_count])\r\n  \r\n    //*******************меняем стиль на кнопке зелёный или красный*** проверено работает***************************************** */\r\n    const [colorBtnClick, setColorBtnClick] = useState('prodpage-control-buttons__indicator');\r\n    useEffect(() => {\r\n      let styleColor = (classNames({\r\n        [style['prodpage-control-buttons__indicator--color__red']]: changeColorBtn.red,\r\n        [style['prodpage-control-buttons__indicator--color__green']]: changeColorBtn.green,\r\n      })\r\n      )\r\n      setColorBtnClick(styleColor)\r\n    }, [changeColorBtn.red, changeColorBtn.green])\r\n  \r\n    //******************************************************************************************************* */\r\n    const linkToProductPage = (url, modalView) => {\r\n      if (!modalView) return null;\r\n      return (\r\n        <Button href={`/${url}`} full variant={'catalog-link-transparent__modal'} onClick = {closeModal}>\r\n          перейти на страницу товара\r\n        </Button>\r\n      );\r\n    };\r\n\r\n\r\n    return (\r\n        <ControlButtons\r\n          linkToProductPage = { linkToProductPage }\r\n          addToCartProduct = {addToCartProduct}\r\n          stateInStockeBtn = { stateInStockeBtn }\r\n          in_cart_count = { in_cart_count }\r\n          colorBtnClick = { colorBtnClick }\r\n          is_collection = { is_collection }\r\n          countInBtn = { countInBtn }\r\n          modalView = { modalView }\r\n          closeModal={closeModal}\r\n          productId = { productId }\r\n          cloneCart = { cloneCart }\r\n          role = { role }\r\n          url = { url }\r\n        />\r\n    )\r\n}\r\n\r\nexport default ControlButtonsContainer;","// extracted by mini-css-extract-plugin\nexport default {\"prodpage-control-buttons__container\":\"controlbuttons_prodpage-control-buttons__container__OdmYl\",\"prodpage-control-buttons__add-to-cart-container\":\"controlbuttons_prodpage-control-buttons__add-to-cart-container__Muj0p\",\"prodpage-control-buttons__add-to-cart-container--fierst\":\"controlbuttons_prodpage-control-buttons__add-to-cart-container--fierst__psbTJ\",\"prodpage-control-buttons__descrement-button\":\"controlbuttons_prodpage-control-buttons__descrement-button__hfezn\",\"prodpage-control-buttons__increment-button\":\"controlbuttons_prodpage-control-buttons__increment-button__pXWxA\",\"prodpage-control-buttons__info-in-cart\":\"controlbuttons_prodpage-control-buttons__info-in-cart__cbKht\",\"prodpage-control-buttons__fierst-add-to-cart\":\"controlbuttons_prodpage-control-buttons__fierst-add-to-cart__qL6Rj\",\"prodpage-control-buttons__inner-button\":\"controlbuttons_prodpage-control-buttons__inner-button__ws4Z9\",\"prodpage-control-buttons__text-button\":\"controlbuttons_prodpage-control-buttons__text-button__dLand\",\"prodpage-control-buttons__indicator\":\"controlbuttons_prodpage-control-buttons__indicator__tPvCr\",\"prodpage-control-buttons__indicator--color__red\":\"controlbuttons_prodpage-control-buttons__indicator--color__red__9+w8X\",\"slidertimer\":\"controlbuttons_slidertimer__+KeWY\"};"],"names":["ControlButtons","AsyncComponent","_ref","in_stock_count","is_collection","in_cart_count","is_in_stock","productId","modalView","role","url","dispatch","useStoreon","_useState","useState","_useState2","_slicedToArray","countInBtn","setCountInBtn","_useState3","_useState4","stateInStockeBtn","setStateInStockeBtn","navigate","useNavigate","_useState5","red","green","_useState6","changeColorBtn","setChangeColorBtn","useEffect","closeModal","show","_useState7","_useState8","colorBtnClick","setColorBtnClick","_classNames","styleColor","classNames","_defineProperty","style","_jsx","linkToProductPage","Button","href","concat","full","variant","onClick","children","addToCartProduct","count","c","_objectSpread","redirectTo","path","timerTimeout","setTimeout","clearTimeout","cloneCart","e","cartIcon","cloneIcon","target","offsetParent","firstChild","cloneNode","cloneBackgroundImage","backgroundImage","cloneIconWidth","offsetWidth","cloneIconHeight","offsetHeight","cloneIconTop","getBoundingClientRect","top","cloneIconLeft","left","classList","add","cssText","document","body","append","getCartId","querySelector","getCartIdTop","getCartIdLeft","timer","remove"],"sourceRoot":""}